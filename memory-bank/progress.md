# Progress

## What Works
- Automatic webhook re-configuration on upload failure
- Localized App Title
- Git commit of all current progress and documentation
- Language Manager (Edit, Create, Progress Tracking)
- Custom Language Dropdown with Flag Icons
- Language Manager UI layout fix for long text content
- Fixed GitHub Release workflow with proper permissions, resource syncing, Linux icon fixes, and race condition prevention
- Modernized Webpack Sass configuration to ensure CSS is correctly applied in production builds
- Hardcoded Webhook URL base in validation to avoid translation issues
- Implemented translation fallback to English for missing keys in other locales
- Project structure with memory-bank documentation system
- README.md updated for Electron version
- Core documentation files initialized (projectbrief, productContext, activeContext, systemPatterns, techContext)
- Draggable floating windows (Theme Manager, Language Manager)
- Dockable panels with unified sidebar support and tabbed interface
- Auto-centering for floating windows on resize (smoother and smarter behavior)
- Electron-based architecture established
- Internationalization system in place (i18n-manager.js)
- Theme management system with localStorage
- Game management system (game-manager.js) with multiple functional views (Cover, List, Table, Slideshow, Random)
- Multi-language support with locale files
- Webpack build system configured
- Memory Card Editor tool (Full-stretch responsive layout, dual-pane management)
- Dedicated "Tools" navigation and overview view

## What
- Complete implementation of game detection and library management
- Full theme management system with custom theme creation
- Implement duplicate theme detection (include all color codes in filename to detect if there are already themes with exact same colors shared/uploaded)
- Complete tools management system
- Advanced game library features (search, filters, sorting)
- Performance optimization for large game collections
- Testing strategies and test coverage
- Deployment procedures and packaging

## Recent Changes
- Continued game-manager refactor: moved slideshow/random views and grouped/incremental rendering into `js/game-manager/views/` and `js/game-manager/rendering/`.
- Continued theme-manager refactor: moved LLM control helpers into `js/theme-manager/llm-utils.js`.
- Continued theme-manager refactor: moved gradient/intensity helpers into `js/theme-manager/editor-utils.js` and background surface helpers into `js/theme-manager/background-editor-utils.js`.
- Continued theme-manager refactor: extracted background layer editor rendering into `js/theme-manager/background-layer-editor.js`.
- Continued theme-manager refactor: moved color collection/derived CSS variable helpers into `js/theme-manager/theme-color-utils.js` and rewired imports/exports.
- Continued theme-manager refactor: extracted theme marketplace fetch logic into `js/theme-manager/marketplace-utils.js`, and moved theme upload/webhook handling into `js/theme-manager/theme-share-utils.js`.
- Continued theme-manager refactor: moved basic brand control helpers into `js/theme-manager/brand-controls-utils.js`.
- Continued theme-manager refactor: moved marketplace rendering into `js/theme-manager/marketplace-view.js`, and moved theme list UI (selector + list rendering) into `js/theme-manager/theme-library-view.js`.
- Continued theme-manager refactor: moved glass/corner appearance helpers into `js/theme-manager/theme-style-utils.js`.
- Continued theme-manager refactor: moved background application logic into `js/theme-manager/theme-background-apply.js`.
- Continued theme-manager refactor: moved editor form wiring + LLM theme apply into `js/theme-manager/theme-editor-controls.js`.
- Continued theme-manager refactor: moved background image listeners/slot handling into `js/theme-manager/theme-background-editor.js`.
- Continued theme-manager refactor: moved save/edit/delete theme actions into `js/theme-manager/theme-actions.js`.
- Continued theme-manager refactor: moved form helpers and color-picker listeners into `js/theme-manager/theme-form-utils.js`.
- Continued theme-manager refactor: moved splash theme sync into `js/theme-manager/theme-splash-utils.js` and theme toggle helpers into `js/theme-manager/theme-toggle-utils.js`.
- Extended emubro-resources configs with launcher import metadata (Steam/Epic/GOG) on Windows platform and Linux package-manager install hints for PCSX2.
- Extended emubro-resources configs across multiple platforms with Linux Flatpak/APT install hints for RetroArch cores, Dolphin, and PPSSPP.
- Continued refactors: moved theme control helpers into `js/theme-manager/theme-controls-utils.js` and moved game launch picker UI into `js/game-manager/launch-picker.js`.
- Continued game-manager refactor: moved search/filter utilities into `js/game-manager/game-search.js`, `js/game-manager/game-filters.js`, and render helpers into `js/game-manager/render-utils.js`, wiring `js/game-manager.js` to delegate.
- Continued theme-manager refactor: extracted editor preview helpers into `js/theme-manager/theme-editor-preview.js`, editor mode toggles into `js/theme-manager/theme-editor-mode.js`, modal drag utilities into `js/theme-manager/theme-modal-utils.js`, and theme runtime logo-brand resolution into `js/theme-manager/theme-runtime-utils.js`.
- Added Linux package-manager install wiring for emulator downloads (Flatpak/APT) with user choice prompt, and extended emulator catalog payloads to include installer metadata.
- Added launcher import flow scaffolding: main-process scanner/importer for Steam/Epic (filesystem manifests), launcher URI launch handling, and library settings UI to trigger launcher scans/imports.
- Added APT sudo-friendly fallback (open terminal if needed), GOG Galaxy sqlite scanning + Heroic cache scanning, and launcher import modal dedupe/badges for already-imported games.
- Added launcher URI fallback execution (open launcher executable when scheme fails), installed-only filtering in launcher import UI, per-launcher tags on import, and preload allowlist entries for launcher scan/import IPC.
- Tweaked header drag region spacing and search container flex in `scss/_header.scss` so the search/theme gap is fully draggable.
- Extracted `js/game-manager` helper modules: `game-utils.js`, `filters-utils.js`, and `launch-candidate-utils.js`, and rewired `js/game-manager.js` to use them.
- Started `js/game-manager.js` refactor by moving runtime data rule normalization helpers into `js/game-manager/runtime-data-utils.js`.
- Fixed infinite renderer RAM growth when switching themes in Library/Cover view:
  - Confirmed issue was native renderer/compositor memory pressure rather than JS heap growth
  - Tuned cover incremental rendering in `js/game-manager.js` to keep fewer chunks/cards resident
  - Scoped lazy image observation to library scroll root in `js/game-manager/lazy-game-images.js` to improve load/unload behavior
  - Removed expensive cover-view visual effects in `scss/games/_core-cover.scss` (blur/shimmer/backdrop-heavy paths)
  - Result: memory now stabilizes after warmup instead of increasing unbounded to GBs
- Fixed category single-mode Ctrl/Cmd multi-select behavior in sidebar categories (logic + visual state)
- Fixed category mode button text interpolation so `{{mode}}` is always rendered to concrete text
- Replaced Library `Installed` section with `Favorite` (games rated with stars / `rating > 0`)
- Added compatibility mapping so legacy stored `installed` default section resolves to `favorite`
- Normalized title-row height treatment across Cover/List/Table to better match Slideshow/Random presentation
- Decoupled logo brand color from global brand color (`--logo-brand-color`) so logo span toggle no longer alters sidebar branding
- Added Font Awesome brand icons for community/social cards
- Fixed Theme Manager custom-theme delete icon rendering and hover action icon consistency
- Improved grouped game rendering behavior and lazy-load batching
- Added markdown rendering for Support view suggested fix steps
- Improved LLM-driven theme generation variance, prompt controls, and color update consistency
- Moved runtime backup rule editing into Emulator Edit modal and removed it from Library Settings modal
- Added emulator-specific `runtimeDataRules` and wired launch payloads so backup matching can be controlled per emulator
- Added game session overlay controls (show launcher, Alt+Enter, screenshot, quit) with active session polling
- Added BIOS Manager tool implementation with platform BIOS listing, file import, and folder open actions
- Updated launch backend to set `lastPlayed` on successful launch for Recently Played reliability
- Refactored `renderer.js` by extracting reusable modules:
  - `js/suggestions-settings.js`
  - `js/suggestions-core.js`
  - `js/suggested-results-view.js`
  - `js/tag-categories.js`
  - `js/ui/glass-message-dialog.js`
  - `js/ui/llm-tagging-dialogs.js`
  - `js/drag-drop-manager.js`
  - `js/window-ui-manager.js`
  - `js/settings/library-settings-modal.js`
  - `js/events/setup-renderer-events.js`
  - `js/profile/profile-modal.js`
  - `js/library/categories-list-renderer.js`
- Reduced renderer surface area and duplicated logic in suggestion/tagging/category flows
- Moved drag/drop import flow out of `renderer.js` into `js/drag-drop-manager.js` and wired via dependency injection callbacks
- Moved window chrome/sidebar/toggle/resize UI handlers into `js/window-ui-manager.js`
- Moved the large settings modal implementation out of `renderer.js` into `js/settings/library-settings-modal.js` with a thin wrapper in renderer
- Moved renderer event wiring into `js/events/setup-renderer-events.js` with dependency injection and state getters
- Moved profile modal UI into `js/profile/profile-modal.js` with a thin wrapper in renderer
- Moved categories sidebar rendering and tag-mutation workflows into `js/library/categories-list-renderer.js` and kept a small renderer wrapper
- Implemented Memory Card Editor with professional dual-pane table-based layout
    - Optimized layout to fill 100% of available space by using absolute positioning and flex-grow
    - Fixed responsive behavior with media queries and stacked layouts for smaller windows
    - Refined table visualization with sticky headers and responsive columns
    - Implemented file-based upload flow for both memory card slots using native file dialogs
    - Added centralized operation controls and bottom action bars
    - Extracted PS1 save icons from memory card files and rendered them in the UI (32x32px size)
    - Debugged and fixed issues with icon rendering (path: null error, incorrect palette/bitmap decoding)
- Implemented emulator download scraping: pages linked via `downloadUrl` are now scraped for archives/installers when direct links are missing, enabling automated downloads from complex provider sites.
- Enhanced emulator package selection UI: the download modal now lists all discovered packages, including those found via scraping, allowing users to choose specific versions or formats.
- Fixed library panel "Search Covers" tab drag-and-drop: implemented local drop zone listeners with `stopPropagation()` to prevent global library import interception, and added a click handler to manually open a file selection dialog.
- Refactored `scss/_tools.scss` into modular files under `scss/tools/` directory (`_core.scss`, `_custom-shortcuts.scss`, `_cover-downloader.scss`, `_cue-maker.scss`, `_ecm-unecm.scss`, `_remote-library.scss`, `_hardware.scss`, `_memory-card.scss`), with `_tools.scss` acting as a central import point.
- Improved "Lucky Shuffle" (Random view) animations: enhanced lever pull feedback with overshoot spring effect, added motion blur to spinning reels, and implemented a delayed fade-in reveal for the selected game title.
- Transformed Slideshow view into a centered "Deck Carousel" with integrated 2D/3D modes: implemented dynamic scaling, opacity, and high-precision 3D rotation effects based on distance from center, magnetic snap-to-center logic, and enhanced drag/inertia physics for a premium console-like experience.
- Fixed header clickability issues: opted language and theme control wrappers out of the `-webkit-app-region: drag` area to ensure reliable interaction across all window widths.
- Improved "Lucky Shuffle" (Random view) logic: redesigned the spin animation to use high-fidelity acceleration and deceleration phases in a consistent forward direction, eliminating jitter and reverse-motion artifacts.
- Implemented collapsed library controls: created a new filters popup system that automatically activates when the sidebar is expanded, preserving horizontal space while keeping platform, region, language, and grouping options easily accessible.
- Added click navigation to Slideshow: enabled direct game card selection in the carousel view, allowing users to jump between games without dragging.
- Fixed a bug where UI layout changes and interactive elements weren't taking effect because the renderer wasn't rebuilt via Webpack in the user's dev environment.
- Added dedicated "Tools" navigation logic to header
    - Created a "Tools Overview" grid view to browse available utilities
    - Implemented seamless switching between the library and tools views
    - **Implemented responsive header with dynamic element visibility and layout adjustments based on screen size.**
- Implemented temporary theme inversion logic for `toggleTheme` (Light <-> Dark color flipping)
- Implemented automatic webhook re-configuration when theme upload fails (e.g., if webhook is deleted on Discord)
- Fixed critical bugs in `GamepadManager`
    - Resolved `TypeError` crash by implementing robust undefined checks and filtering
    - Fixed Bluetooth controller detection by supporting both standard `GamepadEvent` and direct gamepad object payloads
    - Implemented `syncWithNativeAPI` polling fallback to ensure robust detection and fresh state updates for all controllers
- Added future roadmap TODO bank in `memory-bank/activeContext.md` for:
  - Auto save-state/memory-card backup
  - Auto screenshot capture for future multi-cover support
  - In-app game overlay controls
  - BIOS management
  - Controller-first UI navigation
  - Emulator update + save data migration

## Current Status
- Documentation foundation established
- Core architectural patterns defined
- Basic UI components and structure in place
- Internationalization and theme systems partially implemented
- Main process and renderer process communication patterns established

## Known Issues
- Need to implement full game detection and organization features
- Theme system needs more comprehensive custom theme support
- Tools management system requires complete implementation
- Performance optimization for large libraries needed
- Testing coverage is minimal

## Evolution of Project Decisions
- Started with documentation-first approach
- Established Electron architecture early
- Prioritized modular design with separate managers
- Decided on localStorage for theme persistence
- Chose i18n.js for internationalization
- Implemented IPC communication patterns
- Added "Refresh Themes" button in marketplace to fetch community themes from GitHub dynamically
- Implemented a unified docking system for floating panels with tabbed sidebar support
- Fixed and perfected window docking persistence, layout shift, and transition logic
